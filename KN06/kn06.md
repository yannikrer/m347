# B) Verst√§ndnis f√ºr Cluster mit MicroK8s (50%)

## üîÅ Unterschied zwischen `microk8s` und `microk8s kubectl`

`microk8s` ist das Hauptkommando zur Verwaltung der MicroK8s-Umgebung. Es wird verwendet, um den Status des Clusters abzufragen, Nodes hinzuzuf√ºgen oder zu entfernen, Addons zu verwalten usw.

`microk8s kubectl` ist die MicroK8s-eigene Version von `kubectl`, dem Kommandozeilenwerkzeug zur Interaktion mit dem Kubernetes-API-Server. Dar√ºber werden Informationen √ºber Ressourcen im Cluster wie Pods, Nodes und Deployments abgefragt.

---

## Schritt-f√ºr-Schritt Ergebnisse und Beobachtungen

### 1. Ausgabe von `microk8s kubectl get nodes` auf einem zweiten Node (ip-172-31-64-110)

Auf dem Worker-Node `ip-172-31-64-110` wurde folgender Befehl ausgef√ºhrt:

```bash
microk8s kubectl get nodes
```

#### Ausgabe:

```
This MicroK8s deployment is acting as a node in a cluster. Please use the microk8s kubectl on the master.
```

#### Erkl√§rung:

Der Worker-Node kan den Cluster-Zustand nicht direkt √ºber `kubectl` anzeigen, da er kein API-Server-Endpunkt ist. Er verweist darauf, dass man `microk8s kubectl` auf dem Master-Node verwenden soll. Dies zeigt, dass der Worker keine Verwaltungsrolle √ºbernimmt und keine vollst√§ndige Kontrolle √ºber den Cluster besitzt.

---

### 2. Ausgabe von `microk8s kubectl get nodes` auf dem Master (ip-172-31-64-100)

Auf dem Master-Node wurde derselbe Befehl ausgef√ºhrt:

```bash
microk8s kubectl get nodes
```

#### Ausgabe:

```
NAME               STATUS   ROLES    AGE    VERSION
ip-172-31-64-110   Ready    <none>   110s   v1.32.3
```

#### Erkl√§rung:

Hier wurde der Worker-Node erfolgreich erkannt und ist im Status `Ready`. Die Spalte `ROLES` ist leer, da der Node ohne spezielle Rolle (`worker`, `master`) registriert ist, was bei MicroK8s normal ist. Der Master hat Zugriff auf die Kubernetes-API und kann somit den gesamten Clusterzustand einsehen.

---

### Node vom Cluster entfernt

Auf dem Master wurde folgender Befehl ausgef√ºhrt:

```bash
microk8s remove-node ip-172-31-64-110
```

Auf dem Node `ip-172-31-64-110`:

```bash
microk8s leave
```

#### Ergebnis:

Der Node wurde erfolgreich aus dem Cluster entfernt. Er war anschlie√üend nicht mehr √ºber `kubectl get nodes` sichtbar.

---

### Node erneut hinzugef√ºgt ‚Äì als Worker

Auf dem Master-Node:

```bash
microk8s add-node
```

Auf `ip-172-31-64-110` wurde der erhaltene Join-Befehl mit `--worker` ausgef√ºhrt:

```bash
microk8s join <master-ip>:25000/<token> --worker
```

#### Ergebnis:

Der Node wurde erfolgreich wieder in den Cluster integriert ‚Äì diesmal explizit als Worker.

---

### Vergleich der `microk8s status` Ausgaben

#### Auf dem Master (`ip-172-31-64-100`):

```bash
microk8s status
```

Beispielausgabe (gek√ºrzt):

```
microk8s is running
high-availability: yes
  datastore master nodes: 172.31.64.100:19001
```

#### Auf dem Worker (`ip-172-31-64-110`):

```bash
microk8s status
```

Beispielausgabe:

```
microk8s is running
This node is a worker node.
```

#### Erkl√§rung:

- **Master:** zeigt Cluster-Details inkl. HA-Modus und Datenbankrolle.
- **Worker:** zeigt an, dass dieser Node kein Datenbank-Member ist, sondern ausschlie√ülich zur Ausf√ºhrung von Workloads dient.

---

### Letzter Vergleich: `microk8s kubectl get nodes`

#### Auf dem Master (`ip-172-31-64-100`):

```
NAME               STATUS   ROLES    AGE    VERSION
ip-172-31-64-110   Ready    <none>   110s   v1.32.3
```

#### Auf dem Worker (`ip-172-31-64-110`):

```
This MicroK8s deployment is acting as a node in a cluster. Please use the microk8s kubectl on the master.
```

#### Erkl√§rung:

Der Master kann den gesamten Clusterstatus einsehen, w√§hrend der Worker keinen API-Endpunkt enth√§lt und daher keine `kubectl`-Abfragen ausf√ºhren kann. Die Information stimmt trotzdem **indirekt** √ºberein, da alle verwalteten Nodes √ºber den Master sichtbar bleiben ‚Äì so wie es auch in einem zentralisierten Cluster-Design vorgesehen ist.

---

## Zusammenfassung der Ergebnisse

| Node             | Rolle      | `kubectl get nodes` verf√ºgbar? | Statusausgabe         |
|------------------|------------|-------------------------------|------------------------|
| 172.31.64.100     | Master     | ‚úÖ Ja                         | Zeigt Cluster-Infos    |
| 172.31.64.110     | Worker     | ‚ùå Nur Verweis auf Master     | Zeigt Worker-Status    |

---